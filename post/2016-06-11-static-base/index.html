<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Static base - Cinode dev blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="BYO" /><meta name="description" content="Let&amp;rsquo;s talk about blobs Computers understand bits, bits form bytes. Bytes can be ordered into sequence: we end up having blocks of data, blobs. We store them in various places. Running program will need some data inside memory, other part of it will be saved on disk. Some data will be downloaded from servers, CPU will keep some blobs inside it&amp;rsquo;s cache. We can put dozens of examples here, but what this shows is that being so fundamental in computer science, proper data blob management is the key to good application environment." /><meta name="keywords" content="Cinode, privacy, secrecy, decentralized, distributed" />






<meta name="generator" content="Hugo 0.54.0 with theme even" />


<link rel="canonical" href="http://example.org/post/2016-06-11-static-base/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Static base" />
<meta property="og:description" content="Let&rsquo;s talk about blobs Computers understand bits, bits form bytes. Bytes can be ordered into sequence: we end up having blocks of data, blobs. We store them in various places. Running program will need some data inside memory, other part of it will be saved on disk. Some data will be downloaded from servers, CPU will keep some blobs inside it&rsquo;s cache. We can put dozens of examples here, but what this shows is that being so fundamental in computer science, proper data blob management is the key to good application environment." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/post/2016-06-11-static-base/" />
<meta property="article:published_time" content="2016-06-11T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2016-06-11T00:00:00&#43;00:00"/>

<meta itemprop="name" content="Static base">
<meta itemprop="description" content="Let&rsquo;s talk about blobs Computers understand bits, bits form bytes. Bytes can be ordered into sequence: we end up having blocks of data, blobs. We store them in various places. Running program will need some data inside memory, other part of it will be saved on disk. Some data will be downloaded from servers, CPU will keep some blobs inside it&rsquo;s cache. We can put dozens of examples here, but what this shows is that being so fundamental in computer science, proper data blob management is the key to good application environment.">


<meta itemprop="datePublished" content="2016-06-11T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2016-06-11T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1464">



<meta itemprop="keywords" content="design,storage," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Static base"/>
<meta name="twitter:description" content="Let&rsquo;s talk about blobs Computers understand bits, bits form bytes. Bytes can be ordered into sequence: we end up having blocks of data, blobs. We store them in various places. Running program will need some data inside memory, other part of it will be saved on disk. Some data will be downloaded from servers, CPU will keep some blobs inside it&rsquo;s cache. We can put dozens of examples here, but what this shows is that being so fundamental in computer science, proper data blob management is the key to good application environment."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Cinode</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Cinode</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Static base</h1>

      <div class="post-meta">
        <span class="post-time"> 2016-06-11 </span>
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
<ul>
<li><a href="#let-s-talk-about-blobs">Let&rsquo;s talk about blobs</a></li>
<li><a href="#git-has-cas">Git has CAS</a></li>
<li><a href="#what-about-security">What about security?</a></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<h1 id="let-s-talk-about-blobs">Let&rsquo;s talk about blobs</h1>

<p>Computers understand bits, bits form bytes. Bytes can be ordered into sequence:
we end up having blocks of data, blobs. We store them in various places. Running
program will need some data inside memory, other part of it will be saved on disk.
Some data will be downloaded from servers, CPU will keep some blobs inside
it&rsquo;s cache. We can put dozens of examples here, but what this shows is that
being so fundamental in computer science, proper data blob management is the key
to good application environment.</p>

<p>We can&rsquo;t access data without naming blobs in some way. That&rsquo;s why come up with
vrious kinds of addressing. Address could be an URI, file name or just an
address in memory.</p>

<p>There&rsquo;s one special kind of addressing where we generate the name of blob from
the data itself, commonly used in
<a href="https://en.wikipedia.org/wiki/Content-addressable_storage">Content-Addressable Storages</a>
(CAS).
How do we generate the name of object? Well, we usually take some
cryptographically secure hash function, hash the contents of a blob and the
result of the hash function is blob&rsquo;s name.</p>

<p>What would be properties of such hash-based naming scheme?
Let&rsquo;s try to figure our few:</p>

<ol>
<li>Two blobs with equal contents will have the same name, that&rsquo;s how hash
functions work.</li>
<li>If two blobs have same name, they almost certainly
have the same contents. Probability of a different situation is equal to
hash function collision, so
<a href="https://en.wikipedia.org/wiki/Collision_resistance">must be negligible</a>
for any good hash function. This property could be handy in case of
deduplication since we would only have to compare short names of blobs
instead of full contents.</li>
<li>Changing even one bit, or changing the size of blob by even one byte would
generate totally different name. That means there&rsquo;s no way to manipulate
blob data in such way that the resulting keys would expose some properties
we would want (not 100% sure about that, sounds logical but
is there any proof?). This also means that the distribution of keys should be
uniform in the whole key space. It may be crucial if we&rsquo;d like to spread
data across network nodes.</li>
<li>A blob that&rsquo;s stored in CAS can not be modified since any modification would
end up with totally different name. The only way to change is to erase the
old blob and put new one with new name instead.</li>
<li>Since names are so unique it&rsquo;s safe to merge contents of two CAS systems
without conflicts and without data loss (with some basic assumptions of
course such as that there&rsquo;s enough storage space and that the storage is
perfectly durable).
That&rsquo;s pretty easy to understand - all blobs that are in only one source
will not collide due to different names and all blobs that are in both
sources, will have same names and thus same contents (with really high
probability).</li>
</ol>

<h1 id="git-has-cas">Git has CAS</h1>

<p>To understand a bit more what capabilities does Content-Addressable Storage (CAS)
give let&rsquo;s bring a good example where it&rsquo;s used. This example would be:
<a href="https://git-scm.com/">Git</a>, and I can bet most of you have already used it or
at least heard about it.</p>

<p>Every git commit has it&rsquo;s own hash number, for example:
<a href="https://github.com/torvalds/linux/commit/2dcd0af568b0cf583645c8a317dd12e344b1c72a">2dcd0af</a>,
you can see it all around code hosting
websites (sometimes just shortened to few first characters of full hash). This
hash is sha1 of some data blob and uniquely identifies particular code version.
In addition to commits, almost everything in git has a hash name - contents of
a file, directory listing, diff between two data blobs, probably a lot more if
you start digging through git internals.</p>

<p>Those hashes are calculated recursively - for example data blob describing
directory will contain hashes of other directories and files inside.
This could look simillar to
<a href="https://en.wikipedia.org/wiki/Merkle_tree">Merkle tree</a>. One of property of such
structure is that change of one file would only regenerate it&rsquo;s own hash and
hashes of directoories on the path to the root directory, nothing else. Since
this is a tree-like structure, the amount of changes applied has logarithmic
tendency, in other words: should be super fast for large, balanced directory
trees.</p>

<p>Every git blob is unmodifiable. Once generated, you can&rsquo;t change what&rsquo;s behind
the hash assigned to it. You can at most delete it.
If you could change the contents, that would mean you can find sha1 collisions
(so you&rsquo;d prove this hash function is not cryptographically secure). Even the
tiniest change in contents, commit message, commit dates, would result in
totally different hash. That&rsquo;s one of propertie of CAS systems, and indeed Git
internally is one.</p>

<p>But to let us, humans work with commits efficiently, Git adds extra references
(branches, tags, etc) on top of raw commit hashes. References are simillar to
symbolic links in unix filesystems - they are not the content itself. Instead
they are only linking to other locations, hashes in case of git. Link of given
name can be altered and point to something different. That&rsquo;s exactly how branches work.</p>

<p>Some references in git are also given special meaning - i.e. there could be a
&lsquo;stable&rsquo; branch always updated to the most recent stable version of the code.
It will be updated by someone allowed to do so. As long as we trust such person
and there are no security bugs in authorization layers, we could trust the code.
There&rsquo;s a mechanism in Cinode simillar to references in git, but I&rsquo;ll cover it
in some other blog post.</p>

<p>Now there&rsquo;s a funny fact about git, not many of us realize. If we take all git
repos from all around the world, rename all of their branches and tags in way
unique to each repository (for example by prefixing it with repository url),
we would be able to merge all those repos into one giant super-git-repository.</p>

<p>Of couse such merge attempt wouldn&rsquo;t be to practical due to git internals
(some operations do scan all blobs) but it shows that CAS systems could have
world-global namespaces. Actually one of perfect examples of such global system
is <a href="https://en.wikipedia.org/wiki/Kademlia">Kademlia</a> used in trackerless
bittorrent. It shows that global CAS systems can work without any
central server or central management.</p>

<h1 id="what-about-security">What about security?</h1>

<p>Git doesn&rsquo;t have encryption built-in. But other usages of CAS systems
could really benefit from one.</p>

<p>Let&rsquo;s consider any CAS storage as an untrusted party and see it as just a
communication medium between two users that want to securely exchange some
information. If we start putting data onto CAS system, it will gain access to
some obvious information:</p>

<ul>
<li>Names of blobs</li>
<li>Contents of blobs</li>
</ul>

<p>There&rsquo;s also some extra information derived from the one above and from the
communication channel:</p>

<ul>
<li>The amount of data we store</li>
<li>Sizes of particular blobs</li>
<li>Number of blobs</li>
<li>Record of all upload operations metadata including:

<ul>
<li>time of upload</li>
<li>uploader&rsquo;s address</li>
<li>upload speed (even as detailed as function over time)</li>
<li>errors (broken connections, unfinished uploads, reuploaded data etc)</li>
<li>most likely some client software information (name, version etc)</li>
</ul></li>
<li>Record of all download operations metadata including:

<ul>
<li>times of downloads</li>
<li>downloader&rsquo;s address</li>
<li>download speed (up to a function over time)</li>
<li>errors</li>
<li>most likely some client software information (name, version etc)</li>
</ul></li>
</ul>

<p>I&rsquo;m pretty sure this list is barely scratching the surface of what other
information could be extracted. So let&rsquo;s try to first imagine a simplified
problem: let&rsquo;s hide real blob names and real data contents.</p>

<p>Hiding contents is pretty trivial - we just need to use a proven encryption
methods, <a href="https://en.wikipedia.org/wiki/Authenticated_encryption">Authenticated Encryption</a>
most likely. AE does provide confidentiality, integrity and authenticity.
Confidentiality is a must, otherwise someone else would be able to partially or
fully gain the plain blob data.</p>

<p>Integrity is also a must to protect against
unauthorized modification&hellip; hmm, didn&rsquo;t I said before you can&rsquo;t modify data in
CAS? The name of blob, being cryptographically-secure hash function, actually
guarantees integrity. You just can&rsquo;t alter data with given name, you also can&rsquo;t
force your own name.</p>

<p>Now how about authenticity?
According to <a href="https://en.wikipedia.org/wiki/Message_authentication">Wikipedia</a>
it guarantees integrity (which we already have) and data source verification.
I&rsquo;d like to skip authenticity at this point. Why? Because it really doesn&rsquo;t
matter who has uploaded the data. It&rsquo;s important that the name does match the
contents. In case of bare CAS-only storage, authenticity is not that important.
It will be truthly needed later, when we&rsquo;ll be gathering blob names. We have to
get them from somewhere, right? And that information must be authenticated.
I&rsquo;ll discuss here this problem in some future post.</p>

<p>I didn&rsquo;t yet cover one more thing. We&rsquo;ll be encrypting blobs and store encrypted
data into CAS - that way we&rsquo;ll get confidentiality and integrity. We&rsquo;ll also hide
original blob name since we&rsquo;ll be working on names of encrypted blobs instead.
But where we&rsquo;ll get encryption keys and IV from? That&rsquo;s a really good question
and I&rsquo;ll leave it for the next blog post.</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">BYO</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2016-06-11
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/design/">design</a>
          <a href="/tags/storage/">storage</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2016-06-18-password-please/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Password please</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2016-06-02-humble-beginning/">
            <span class="next-text nav-default">Humble beginning</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="http://example.org/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2016 - 
    2021
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">BYO</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script><script></script><script src="https://cdn.jsdelivr.net/npm/raphael@2.2.7/raphael.min.js" integrity="sha256-67By+NpOtm9ka1R6xpUefeGOY8kWWHHRAKlvaTJ7ONI=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/flowchart.js@1.8.0/release/flowchart.min.js" integrity="sha256-zNGWjubXoY6rb5MnmpBNefO0RgoVYfle9p0tvOQM+6k=" crossorigin="anonymous"></script><script></script><script src="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.js" integrity="sha256-4O4pS1SH31ZqrSO2A/2QJTVjTPqVe+jnYgOWUVr7EEc=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/snapsvg@0.5.1/dist/snap.svg-min.js" integrity="sha256-oI+elz+sIm+jpn8F/qEspKoKveTc5uKeFHNNVexe6d8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/underscore@1.8.3/underscore-min.js" integrity="sha256-obZACiHd7gkOk9iIL/pimWMTJ4W/pBsKu+oZnSeBIek=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/gh/bramp/js-sequence-diagrams@2.0.1/dist/sequence-diagram-min.js" integrity="sha384-8748Vn52gHJYJI0XEuPB2QlPVNUkJlJn9tHqKec6J3q2r9l8fvRxrgn/E5ZHV0sP" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/bramp/js-sequence-diagrams@2.0.1/dist/sequence-diagram-min.css" integrity="sha384-6QbLKJMz5dS3adWSeINZe74uSydBGFbnzaAYmp+tKyq60S7H2p6V7g1TysM5lAaF" crossorigin="anonymous">
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"  integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>








</body>
</html>
